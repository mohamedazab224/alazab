<!DOCTYPE html>
<html lang="en">
<head>
   <meta charset="UTF-8">
   <meta http-equiv="X-UA-Compatible" content="IE=edge">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>Alazab Construction</title>

   <link rel="icon" href="https://i.ibb.co/0YFvRQG/AZASDFGHJK.png" type="image/png">

   <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
   <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/lightgallery-js/1.4.0/css/lightgallery.min.css">
   <link rel="stylesheet" href="https://unpkg.com/swiper@7/swiper-bundle.min.css" />
   <link rel="stylesheet" href="css/style.css">
   <style>
      .popup {
         position: fixed;
         top: 0;
         left: 0;
         width: 100%;
         height: 100%;
         background: rgba(0, 0, 0, 0.7);
         display: flex;
         justify-content: center;
         align-items: center;
         visibility: hidden;
         opacity: 0;
         transition: visibility 0s, opacity 0.5s ease;
      }
      .popup.active {
         visibility: visible;
         opacity: 1;
      }
      .popup-content {
         background: #fff;
         padding: 20px;
         border-radius: 5px;
         text-align: center;
         width: 90%;
         max-width: 400px;
      }
      .popup-content input[type="text"],
      .popup-content input[type="email"] {
         width: calc(100% - 20px);
         padding: 10px;
         margin: 10px 0;
         border: 1px solid #ccc;
         border-radius: 5px;
      }
      .popup-content .btn {
         background: #333;
         color: #fff;
         border: none;
         padding: 10px 20px;
         cursor: pointer;
         border-radius: 5px;
      }
      .popup-content .close-btn {
         background: #e74c3c;
         color: #fff;
         border: none;
         padding: 5px 10px;
         cursor: pointer;
         border-radius: 5px;
         margin-top: 10px;
      }
   </style>
</head>
<body>
   <!-- Subscription Popup -->
   <div class="popup" id="subscription-popup">
      <div class="popup-content">
         <h3>Subscribe to Our Newsletter</h3>
         <form id="subscription-form">
            <input type="text" name="user_name" placeholder="Your Name" required>
            <input type="email" name="user_email" placeholder="Your Email" required>
            <input type="submit" value="Subscribe" class="btn">
         </form>
         <button class="close-btn" onclick="closePopup()" aria-label="Close Popup">Close</button>
      </div>
   </div>
   <div id="loading-spinner" style="display:none;">Loading...</div>

   <script defer src="https://cdn.jsdelivr.net/npm/emailjs-com@2.4.1/dist/email.min.js"></script>
   <script defer src="js/emailjs_contact_form.js"></script>
   <script>
      (async function() {
         const response = await fetch('/api/get-emailjs-key');
         const data = await response.json();
         emailjs.init(data.key);
      })();

      document.getElementById('subscription-form').addEventListener('submit', function(event) {
         event.preventDefault();

         document.getElementById('loading-spinner').style.display = 'block';

         emailjs.sendForm('service_Alazab.co', 'template_tvn06ki', this)
            .then(function() {
               alert('Thank you for subscribing!');
               closePopup();
            }, function(error) {
               alert('Failed to subscribe. Please try again later.');
            })
            .finally(function() {
               document.getElementById('loading-spinner').style.display = 'none';
            });
      });

      window.onload = function() {
         setTimeout(function() {
            document.getElementById('subscription-popup').classList.add('active');
         }, 3000);
      }

      function closePopup() {
         document.getElementById('subscription-popup').classList.remove('active');
      }
   </script>
</body>
</html>
